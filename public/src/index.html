<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- my javascript file 
    <script type="text/javascript" src="./index.js"></script>-->

    <!--react -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- jquery -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.js"></script>
    <style type="text/css">
      body {
        margin : 150px;
        border: 2px red solid ;
        padding : 10px;
        border-radius: 20px;
        background: gray;
      }
      input {
        width: 250px;
        display : block;
        margin: 10px;
      } 
      input {
        width: 150 auto;
      }
      span , ins {
        font-size: 20px;
        padding : 10 px;
      }
       button {
        width: 150px;
        height: 50px;
        display : block;
        margin: 10px;
        font-size: 15px;
      } 
      
    </style>
  </head>
  <body>
    <div id="App">
      <App />
    </div>

    <script type="text/babel">
      
  var App = React.createClass({
        constructore : () =>{
        Super()
      },
        render : () => {
          return (<div class="cont">
                    <h1>click to get you tasks</h1>        
                    <button onClick={()=>{
                        $.ajax({
                          url : 'http://127.0.0.1:3000/tasks',
                          type: 'GET' ,
                          success : (data)=>{
                            console.log('get tasks sent, first task is :', data[0]);
                            if (data.length > 10) {
                                data = data.slice(data.length-10);
                            }
                            ReactDOM.render(<Taskslist list={data}/>, document.getElementById('container'));
                          },
                          error : (err)=>{console.log('get tasks failed')}
                        })
                      }}>get tasks</button>
                    <Tasks />
                    </div>
                  )
                }
    })


    var Tasks = React.createClass({
            render : () => {
              return (
                    <div>                              
                      <input type="text" id="name" placeholder="name" />
                      <input type="text" id="task" placeholder="to do !!"/>
                      <button onClick={() => {
                                      var name = $('#name').val();
                                      var task = $('#task').val();
                            
                                      $.ajax({
                                        type : 'POST',
                                        url : 'http://127.0.0.1:3000/tasks',
                                        data : {name: name , task: task},
                                        success : function(data) {
                                          console.log('sent post task');
                                          
                                        },
                                        error : () => {console.log('error sending post task')}
                                      })
                                    }
                                  }
                      >
                      post
                      </button>
                      <div id="container" >
                      </div>
                    </div>)
                
              }
          })

    class Taskslist extends React.Component {
            constructore = (props) =>{
                Super(props);
                console.log('props.list2');
              }
            bindings = {
              list : '='
            }
            render = () => {
              console.log('inside Taskslist and props is ', this.props.list);
              const listTasks =  this.props.list.map((todo) => <div>
              <hr/>
                      <span>name : {todo.name}</span><br/>
                      <ins>todo : {todo.task}</ins>
                      
                    </div>);
              return (
                    <div>

                    {listTasks}
                    </div>)
                
              }
          }
 
    ReactDOM.render(<App />, document.getElementById('App'));
   </script>

  </body>
</html>


